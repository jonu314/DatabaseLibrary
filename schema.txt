DROP DATABASE Proj1;
CREATE DATABASE IF NOT EXISTS Proj1;
USE Proj1;

CREATE TABLE IF NOT EXISTS BOOK (
  isbn   CHARACTER(10) NOT NULL PRIMARY KEY,
  Title  VARCHAR(250) NOT NULL
);
CREATE TABLE IF NOT EXISTS AUTHORS (
    Author_id INT AUTO_INCREMENT PRIMARY KEY,
    Name VARCHAR(255) UNIQUE NOT NULL
);
CREATE TABLE IF NOT EXISTS BOOK_AUTHORS (
    isbn CHAR(10),
    author_id INT,
    PRIMARY KEY (isbn, author_id),
    FOREIGN KEY (author_id) REFERENCES AUTHORS(author_id),
    FOREIGN KEY (isbn) REFERENCES BOOK(isbn) 
);
CREATE TABLE IF NOT EXISTS BORROWER (
    card_id  CHAR(8) NOT NULL PRIMARY KEY,
    ssn      CHAR(11) NOT NULL,
    Bname    VARCHAR(25) NOT NULL,
    address  VARCHAR(100) NOT NULL,  
    phone    CHAR(14) NOT NULL, 
    email    VARCHAR(50) NOT NULL,
    city 	 VARCHAR(25) NOT NULL, 
    state	 VARCHAR(25) NOT NULL
);

CREATE TABLE IF NOT EXISTS BOOK_LOANS (
    loan_id INT NOT NULL,
    isbn CHAR(10) NOT NULL,
    card_id CHAR(8) NOT NULL,
    date_out DATE NOT NULL,
    due_date DATE NOT NULL,
    date_in DATE,
    PRIMARY KEY (loan_id),
    FOREIGN KEY (isbn) REFERENCES BOOK(isbn),
    FOREIGN KEY (card_id) REFERENCES BORROWER(card_id)
);

CREATE TABLE IF NOT EXISTS FINES (
    loan_id INT NOT NULL,
    fine_amt DECIMAL(10,2) NOT NULL,
    paid INT NOT NULL,
    PRIMARY KEY (loan_id),
    FOREIGN KEY (loan_id) REFERENCES BOOK_LOANS(loan_id)
);

INSERT INTO BOOK (isbn, Title) VALUES (1234567891, "Hello");
INSERT INTO AUTHORS (Name) VALUES ("John Doe");
INSERT INTO BOOK_AUTHORS (isbn, Author_id) VALUES (1234567891, 1);
